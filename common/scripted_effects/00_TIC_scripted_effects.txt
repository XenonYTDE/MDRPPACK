############################
### TIC scripted effects ###
############################

update_TIC_dirty_variable = {
	if = { limit = { check_variable = { global.TIC_dirty_update_var < 10000 } }
		add_to_variable = { global.TIC_dirty_update_var = 1 }
	}
	else = {
		set_variable = { global.TIC_dirty_update_var = 1 }
	}
}

TIC_tab_selection = {
	clr_country_flag = TIC_offices_tab_open
	clr_country_flag = TIC_info_tab_open
	clr_country_flag = TIC_parliament_tab_open
	clr_country_flag = TIC_council_tab_open
	clr_country_flag = TIC_bank_tab_open
	clr_country_flag = TIC_legislations_tab_open
	update_TIC_dirty_variable = yes
}

TIC_var_update = {

	# Member count
	set_variable = { var = global.TIC_member_count value = 0 }
		for_each_scope_loop = {
			array = global.TIC_member
			add_to_variable = { global.TIC_member_count = 1 }
		}
	# Total population
	set_variable = { var = global.TIC_poptotal value = 0 }
	for_each_scope_loop = {
		array = global.TIC_member
		set_temp_variable = { converted_manpower = max_manpower_k }
		divide_temp_variable = { converted_manpower = 1000 }
		add_to_variable = { global.TIC_poptotal = converted_manpower }
	}
	# Population ratio
	for_each_scope_loop = {
		array = global.TIC_member
		set_variable = { THIS.TIC_popratio = 0 }
		add_to_variable = { THIS.TIC_popratio = THIS.max_manpower_k }
		divide_variable = { THIS.TIC_popratio = global.TIC_poptotal }
	}
	# Total GDP
	set_variable = { var = global.TIC_gdptotal value = 0 }
	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { global.TIC_gdptotal = THIS.gdp_total }
	}
	# Total GDP/C
	set_variable = { var = global.TIC_gdpc value = 0 }
	add_to_variable = { global.TIC_gdpc = global.TIC_gdptotal }
	divide_variable = { global.TIC_gdpc = global.TIC_poptotal }
	# Total Factories
	set_variable = { var = global.TIC_factories value = 0 }
	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { global.TIC_factories = THIS.num_of_factories }
	}
	# Total Civs
	set_variable = { var = global.TIC_civs value = 0 }
	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { global.TIC_civs = THIS.num_of_civilian_factories }
	}
	# Total Mils
	set_variable = { var = global.TIC_mils value = 0 }
	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { global.TIC_mils = THIS.num_of_military_factories }
	}
	# Total Docks
	set_variable = { var = global.TIC_docks value = 0 }
	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { global.TIC_docks = THIS.num_of_naval_factories }
	}
	# Global Unity
	set_variable = { var = global.TIC_unity value = 0 }
	set_variable = { var = global.TIC_unity max = 1 }
	set_variable = { var = global.TIC_unity min = 0 }
	set_variable = { var = THIS.TIC_c_unity max = 1 }
	set_variable = { var = THIS.TIC_c_unity min = 0 }
	clamp_variable = { var = global.TIC_unity min = 0 max = 1}
	clamp_variable = { var = THIS.TIC_c_unity min = 0 max = 1}
	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { global.TIC_unity = THIS.TIC_c_unity }
	}
	divide_variable = { global.TIC_unity = global.TIC_member_count }
	# G Unity PP Cost
	set_variable = { var = TIC_unity_pp_cost value = 10 }
	multiply_variable = { TIC_unity_pp_cost = global.TIC_member_count }
	set_variable = { var = TIC_unity_pp_cost_limit value = TIC_unity_pp_cost }
	add_to_variable = { TIC_pp_cost_limit = 1 }
	multiply_variable = { TIC_unity_pp_cost = -1 }

	update_TIC_dirty_variable = yes

}

TIC_g_unity_increase = {

	for_each_scope_loop = {
		array = global.TIC_member
		add_to_variable = { THIS.TIC_c_unity = 0.01 }
		clamp_variable = { var = global.TIC_unity min = 0 max = 1}
		clamp_variable = { var = THIS.TIC_c_unity min = 0 max = 1}
	}
}
TIC_g_unity_decrease = {

	for_each_scope_loop = {
		array = global.TIC_member
		subtract_from_variable = { THIS.TIC_c_unity = 0.01 }
		clamp_variable = { var = global.TIC_unity min = 0 max = 1}
		clamp_variable = { var = THIS.TIC_c_unity min = 0 max = 1}
	}
}

TIC_parliament_init = {
	BRA = {
		add_ideas = mao_zedong_thought
	}
	# Available Laws
	add_to_array = { global.TIC_available_laws = 100 }
	add_to_array = { global.TIC_available_laws = 101 }
	add_to_array = { global.TIC_available_laws = 102 }
	add_to_array = { global.TIC_available_laws = 103 }
	add_to_array = { global.TIC_available_laws = 104 }
	add_to_array = { global.TIC_available_laws = 105 }
	add_to_array = { global.TIC_available_laws = 106 }
	add_to_array = { global.TIC_available_laws = 107 }
	add_to_array = { global.TIC_available_laws = 108 }
	add_to_array = { global.TIC_available_laws = 109 }
	add_to_array = { global.TIC_available_laws = 110 }
	add_to_array = { global.TIC_available_laws = 111 }
	# Available Expansions
	add_to_array = { global.TIC_available_expansions = 100 }
	add_to_array = { global.TIC_available_expansions = 101 }
	add_to_array = { global.TIC_available_expansions = 102 }
	add_to_array = { global.TIC_available_expansions = 103 }
	add_to_array = { global.TIC_available_expansions = 104 }
	add_to_array = { global.TIC_available_expansions = 105 }
	add_to_array = { global.TIC_available_expansions = 106 }
	add_to_array = { global.TIC_available_expansions = 107 }
	add_to_array = { global.TIC_available_expansions = 108 }
	add_to_array = { global.TIC_available_expansions = 109 }
	add_to_array = { global.TIC_available_expansions = 110 }
	add_to_array = { global.TIC_available_expansions = 111 }
}

TIC_parl_elections = {

	
}