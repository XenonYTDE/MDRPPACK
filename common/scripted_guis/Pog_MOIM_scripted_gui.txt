# Author: Lynxivium
scripted_gui = {

	MOIM_open_button_gui = {
		context_type = player_context
		window_name = "MOIM_button"
		parent_window_name = "MapmodesInterface_Ingame"

		visible = { 
			always = yes
		}

		effects = {
			MOIM_open_button_click = {
				if = {
					limit = { NOT = { has_country_flag = MOIM_open_flag } }
					set_country_flag = MOIM_open_flag
				}
				else = {
					clr_country_flag = MOIM_open_flag
				}
			}
		}
	}

	MOIM_main_gui = {
		context_type = player_context
		window_name = "MOIM_main"

		visible = { 
			has_country_flag = MOIM_open_flag 
		}

		effects = {
			# Main
			MOIM_close_button_click = {
				clr_country_flag = MOIM_open_flag
			}
			MOIM_unlock_button_click = {
				if = {
					limit = { has_political_power > 499 }
					add_political_power = -500
					set_country_flag = MOIM_bought_flag
					add_dynamic_modifier = {
						modifier = moim_doir_dynmod
					}
					set_variable = { moim_pp_factor = 0 }
					set_variable = { moim_cp_factor = 0 }
					set_variable = { moim_army_xp_factor = 0 }
					set_variable = { moim_navy_xp_factor = 0 }
					set_variable = { moim_air_xp_factor = 0 }
				}
			}
			MOIM_dop_unlock_button_click = {
				if = {
					limit = { has_political_power > 499 }
					add_political_power = -500
					set_country_flag = MOIM_dop_bought_flag
				}
			}
			MOIM_dom_unlock_button_click = {
				if = {
					limit = { has_political_power > 499 }
					add_political_power = -500
					set_country_flag = MOIM_dom_bought_flag
				}
			}
			MOIM_dorad_unlock_button_click = {
				if = {
					limit = { has_political_power > 499 }
					add_political_power = -500
					set_country_flag = MOIM_dorad_bought_flag
				}
			}
			# Department of Internal Resources 
			MOIM_pp_button_click = {
				if = {
					limit = { 
						has_political_power > 199
						check_variable = { moim_pp_factor < 0.50 }
					}
					add_political_power = -200
					MOIM_change_pp_factor_effect = yes
				}
			}
			MOIM_cp_button_click = {
				if = {
					limit = { 
						has_political_power > 199
						command_power > 49
						check_variable = { moim_cp_factor < 0.50 }
					}
					add_political_power = -200
					add_command_power = -50
					MOIM_change_cp_factor_effect = yes
				}
			}
			MOIM_xp_button_click = {
				if = {
					limit = {
						has_political_power > 99
						has_army_experience > 49
						has_navy_experience > 49
						has_air_experience > 49
						check_variable = { moim_army_xp_factor < 0.25 }
					}
					add_political_power = -100
					army_experience = -50
					navy_experience = -50
					air_experience = -50
					MOIM_change_army_xp_factor_effect = yes
					MOIM_change_navy_xp_factor_effect = yes
					MOIM_change_air_xp_factor_effect = yes
				}
			}
		}

		triggers = {
			MOIM_unlock_button_visible = {
				NOT = { 
					has_country_flag = MOIM_bought_flag
				}
			}
			MOIM_main_overlay_visible = {
				NOT = { 
					has_country_flag = MOIM_bought_flag
				}
			}
			MOIM_doir_overlay_visible = {
				NOT = { 
					has_country_flag = MOIM_bought_flag
				}
			}
			MOIM_dop_overlay_visible = {
				NOT = { 
					has_country_flag = MOIM_dop_bought_flag
				}
			}
			MOIM_dop_unlock_button_visible = {
				NOT = { 
					has_country_flag = MOIM_dop_bought_flag
				}
			}
			MOIM_dom_overlay_visible = {
				NOT = { 
					has_country_flag = MOIM_dom_bought_flag
				}
			}
			MOIM_dom_unlock_button_visible = {
				NOT = { 
					has_country_flag = MOIM_dom_bought_flag
				}
			}
			MOIM_dorad_overlay_visible = {
				NOT = { 
					has_country_flag = MOIM_dorad_bought_flag
				}
			}
			MOIM_dorad_unlock_button_visible = {
				NOT = { 
					has_country_flag = MOIM_dorad_bought_flag
				}
			}
		}
	}

}